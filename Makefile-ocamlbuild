
.PHONY: all clean byte native top plugin

all: byte lib

byte: lib
	ocamlfind ocamlc -thread -package atd,nonstd,smart_print -linkpkg \
	  -I _build/src/lib/ atd2cconv.cma src/app/main.ml -o atd2cconv

LIB_STUFF=src/lib/atd2cconv.cma src/lib/atd2cconv.cmxa src/lib/atd2cconv.cmxs 
lib:
	ocamlbuild -tag thread -use-ocamlfind -package atd,nonstd,smart_print $(LIB_STUFF)


install:
	ocamlfind install atd2cconv \
	  _build/src/lib/atd2cconv.a \
	  _build/src/lib/atd2cconv.cma \
	  _build/src/lib/atd2cconv.cmi \
	  _build/src/lib/atd2cconv.cmx \
	  _build/src/lib/atd2cconv.cmxa \
	  _build/src/lib/atd2cconv.cmxs \
	  _build/src/lib/atd2cconv.mli \
	  META && cp atd2cconv $(BINDIR)

clean:
	rm -fr _build atd2cconv
